import{c as h,e as l,l as n,S as d,a as f,Q as _,D as w,b as k,R as m,O as y,d as v,F as L,f as A,C as P,I as S,g as b,L as x}from"./index-5ff5c070.js";import{A as M,h as j,K as J,i as K}from"./index-5ff5c070.js";class W{constructor(e,t){this._modeId=e,this._defaults=t,this._worker=null,this._client=null,this._configChangeListener=this._defaults.onDidChange(()=>this._stopWorker()),this._updateExtraLibsToken=0,this._extraLibsChangeListener=this._defaults.onDidExtraLibsChange(()=>this._updateExtraLibs())}dispose(){this._configChangeListener.dispose(),this._extraLibsChangeListener.dispose(),this._stopWorker()}_stopWorker(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null}async _updateExtraLibs(){if(!this._worker)return;const e=++this._updateExtraLibsToken,t=await this._worker.getProxy();this._updateExtraLibsToken===e&&t.updateExtraLibs(this._defaults.getExtraLibs())}_getClient(){return this._client||(this._client=(async()=>(this._worker=h({moduleId:"vs/language/typescript/tsWorker",createWorker:()=>new Worker(new URL("/assets/ts.worker-425918ce.js",self.location),{type:"module"}),label:this._modeId,keepIdleModels:!0,createData:{compilerOptions:this._defaults.getCompilerOptions(),extraLibs:this._defaults.getExtraLibs(),customWorkerPath:this._defaults.workerOptions.customWorkerPath,inlayHintsOptions:this._defaults.inlayHintsOptions}}),this._defaults.getEagerModelSync()?await this._worker.withSyncedResources(l.getModels().filter(e=>e.getLanguageId()===this._modeId).map(e=>e.uri)):await this._worker.getProxy()))()),this._client}async getLanguageServiceWorker(...e){const t=await this._getClient();return this._worker&&await this._worker.withSyncedResources(e),t}}let o,p;function H(r){p=u(r,"typescript")}function D(r){o=u(r,"javascript")}function T(){return new Promise((r,e)=>{if(!o)return e("JavaScript not registered!");r(o)})}function F(){return new Promise((r,e)=>{if(!p)return e("TypeScript not registered!");r(p)})}function u(r,e){const t=[],c=new W(e,r),i=(...s)=>c.getLanguageServiceWorker(...s),a=new x(i);function g(){const{modeConfiguration:s}=r;C(t),s.completionItems&&t.push(n.registerCompletionItemProvider(e,new d(i))),s.signatureHelp&&t.push(n.registerSignatureHelpProvider(e,new f(i))),s.hovers&&t.push(n.registerHoverProvider(e,new _(i))),s.documentHighlights&&t.push(n.registerDocumentHighlightProvider(e,new w(i))),s.definitions&&t.push(n.registerDefinitionProvider(e,new k(a,i))),s.references&&t.push(n.registerReferenceProvider(e,new m(a,i))),s.documentSymbols&&t.push(n.registerDocumentSymbolProvider(e,new y(i))),s.rename&&t.push(n.registerRenameProvider(e,new v(a,i))),s.documentRangeFormattingEdits&&t.push(n.registerDocumentRangeFormattingEditProvider(e,new L(i))),s.onTypeFormattingEdits&&t.push(n.registerOnTypeFormattingEditProvider(e,new A(i))),s.codeActions&&t.push(n.registerCodeActionProvider(e,new P(i))),s.inlayHints&&t.push(n.registerInlayHintsProvider(e,new S(i))),s.diagnostics&&t.push(new b(a,r,e,i))}return g(),i}function C(r){for(;r.length;)r.pop().dispose()}export{M as Adapter,P as CodeActionAdaptor,k as DefinitionAdapter,b as DiagnosticsAdapter,w as DocumentHighlightAdapter,L as FormatAdapter,j as FormatHelper,A as FormatOnTypeAdapter,S as InlayHintsAdapter,J as Kind,x as LibFiles,y as OutlineAdapter,_ as QuickInfoAdapter,m as ReferenceAdapter,v as RenameAdapter,f as SignatureHelpAdapter,d as SuggestAdapter,W as WorkerManager,K as flattenDiagnosticMessageText,T as getJavaScriptWorker,F as getTypeScriptWorker,D as setupJavaScript,H as setupTypeScript};
